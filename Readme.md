# Medida technical test

## Description
This repo shows the solution to the technical test for the Medida company, explained [here](medida_docs/Readme.md). The solution is implemented in Python and uses the FastAPI framework to create a REST API.
The app has a single endpoint (`/events`) that receives a POST request with a JSON payload containing the dates of the events to be obtained, and the league to which the events belong. The app then returns all the information following the OpenAPI schema defined in [here](docs/apispecs/challenge-api/openapi.yaml)
This data is generated by calling two different endpoints from a mock 3rd party API, that returns the events for the given league, dates and team's ranking. All this information is grouped and presented as desired, just as indicated in the OpenAPI file above.

## Launching the app
To launch the app, you need to have Docker installed. Then, you can run the following command:
```bash
docker-compose up -d
```
This command will build the Docker image and run the app container and the mock 3rd party API. The app will be available at `http://localhost:18000`.

Once the app is running, you can test it by sending a POST request to `http://localhost:18000/events` with the following curl command:
```bash
curl -X POST \
  -H "Content-Type: application/json" \
  -d '{"league": "NFL", "startDate": "2024-04-01", "endDate": "2024-04-30"}' \
  http://localhost:18000/events
# Response
# {"events":[{"eventId":"5055c2a2-af68-4082-9834-ceb36dd0a807","eventDate":"2023-01-11","eventTime":"14:00:00","homeTeamId":"8da0c96d-7b3d-41f3-9e68-29607f3babcf","homeTeamNickName":"Atlanta Falcons","homeTeamCity":"Atlanta","homeTeamRank":3, ...
```

You can also run the python file `test.py` to test the app. The file sends a POST request to the app and prints the response. This scripts has 1 correct payload and 3 incorrect payloads to test the app's error handling. You will need to have the `requests` library installed to run the script.

### Launching the tests
To launch test, install `pytest` and run the following command:
```bash
pytest -v
```

## Improvement points
1. To avoid repeated calls to the third-party API, there should be a way to store previously requested information (such as a database). With this functionality, the application would first request information from the database; if any information is missing, it would only request the missing information from the third-party API.
However, it would be necessary to consider how to differentiate between information that does not exist and information that is still pending. For example:
* User requests information for the entire month of January for League A.
* This information is not in the database, so the app requests it from the third-party API, processes it, saves it in the database, and returns it to the user.
* The same user requests information again: for the entire months of January and February for League A.
* The app checks that it already has data for January but not for February, so it requests February data from the third-party API.
* League A had no games played in February, so it returns no data.
* The app returns only the January information because it's the only data available.
* If the user were to repeat the request (January + February), the request to the third-party API would be repeated every time.

A solution is needed to store data that has been requested but does not exist, to avoid the scenario described above. One possibility would be to have all dates covered in the database, but the number of rows without information could affect the database's performance.

2. Consider having more than one third-party API to request information from. This would allow the app to continue working even if one of the APIs is down. Consider adding preference to one API over another, depending on the response time or the number of requests made.

3. Add logging to the app to monitor its performance and to help debug any issues that may arise.